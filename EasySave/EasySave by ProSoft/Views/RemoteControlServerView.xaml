<UserControl x:Class="EasySave_by_ProSoft.Views.RemoteControlServerView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:EasySave_by_ProSoft.Views"
             xmlns:localization="clr-namespace:EasySave_by_ProSoft.Localization"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="Remote Control Server" 
                       FontSize="24" 
                       FontWeight="Bold" 
                       Margin="0,0,0,10"/>
            <TextBlock Text="Allow remote clients to connect and control backup jobs" 
                       TextWrapping="Wrap"/>
        </StackPanel>

        <!-- Server Control Panel -->
        <Grid Grid.Row="1" Margin="0,0,0,20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="80"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <TextBlock Grid.Column="0" 
                       Text="Server Port:" 
                       VerticalAlignment="Center" 
                       Margin="0,0,10,0"/>
            
            <TextBox Grid.Column="1" 
                     x:Name="ServerPortTextBox"
                     Text="{Binding ServerPort, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                     VerticalAlignment="Center" 
                     Margin="0,0,20,0"/>
            
            <Button Grid.Column="2" 
                    Content="{Binding ServerButtonText}" 
                    Command="{Binding ToggleServerCommand}" 
                    Width="120"
                    Padding="10,5"
                    Background="{Binding ServerButtonColor}"/>
        </Grid>

        <!-- Status Display -->
        <Border Grid.Row="1" 
                Background="{Binding ServerStatusBackground}" 
                Padding="10" 
                Margin="0,0,0,10"
                VerticalAlignment="Bottom">
            <TextBlock Text="{Binding ServerStatus}" 
                       Foreground="White" 
                       TextWrapping="Wrap"/>
        </Border>

        <!-- Connected Clients List -->
        <Grid Grid.Row="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            
            <TextBlock Grid.Row="0" 
                       Text="Connected Clients" 
                       FontSize="18" 
                       FontWeight="SemiBold" 
                       Margin="0,0,0,10"/>
            
            <ListView Grid.Row="1" 
                      x:Name="ClientsListView"
                      ItemsSource="{Binding ConnectedClients}" 
                      BorderThickness="1" 
                      BorderBrush="{StaticResource BorderBrush}">
                <ListView.View>
                    <GridView>
                        <GridViewColumn Header="Client ID" 
                                        DisplayMemberBinding="{Binding ClientId}" 
                                        Width="300"/>
                        <GridViewColumn Header="Connected Since" 
                                        DisplayMemberBinding="{Binding ConnectedSince}" 
                                        Width="200"/>
                        <GridViewColumn Header="IP Address" 
                                        DisplayMemberBinding="{Binding IpAddress}" 
                                        Width="150"/>
                    </GridView>
                </ListView.View>
            </ListView>
            
            <!-- No clients overlay -->
            <TextBlock Grid.Row="1" 
                       HorizontalAlignment="Center" 
                       VerticalAlignment="Center" 
                       Text="No clients connected. Start the server and wait for connections."
                       Visibility="{Binding NoClientsVisibility}"
                       FontSize="16" 
                       Foreground="{StaticResource TextMutedBrush}"/>
        </Grid>

        <!-- Local Network Information -->
        <StackPanel Grid.Row="3" Margin="0,20,0,0">
            <TextBlock Text="Local Network Information" 
                       FontSize="16" 
                       FontWeight="SemiBold" 
                       Margin="0,0,0,10"/>
            
            <TextBlock Margin="0,0,0,5">
                <Run Text="Local IP Address: "/>
                <Run Text="{Binding LocalIpAddress, Mode=OneWay}" FontWeight="SemiBold"/>
            </TextBlock>
            
            <TextBlock>
                <Run Text="For clients to connect, ensure port "/>
                <Run Text="{Binding ServerPort}" FontWeight="SemiBold"/>
                <Run Text=" is open on your firewall."/>
            </TextBlock>
        </StackPanel>
    </Grid>
</UserControl>